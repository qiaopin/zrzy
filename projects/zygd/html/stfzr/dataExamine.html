<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="../../js/layui-v2.4.5/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../js/layer/theme/default/layer.css"/>
    <link rel="stylesheet" type="text/css" href="../../js/openlayers/ol.css"/>
    <link rel="stylesheet" type="text/css" href="../../js/zTreeStyle/zTreeStyle.css"/>
    <style>
        body {
            overflow: hidden;
        }

        .top {
            height: 50vh;
            width: 100%;
            background: #F8F8F8;
            position: relative;
        }

        .bottom {
            height: 50vh;
            width: 100%;
            background: #F8F8F8;
            position: relative;
        }

        .top-left {
            height: calc(100% - 15px);
            width: calc(100% - 20px);
            background: #fff;
            position: absolute;
            left: 10px;
            top: 10px;
        }

        .top-right {
            height: calc(100% - 15px);
            width: calc(100% - 20px);
            background: #fff;
            position: absolute;
            left: 10px;
            top: 5px;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .title_div {
            height: 28px;
            color: #3A6992;
            line-height: 22px;
            padding: 0px 10px;
            position: relative;
        }

        .strong {
            font-weight: 900;
        }

        .year {
            color: #07323B;
        }

        .quarter {
            color: #07323B;
            margin-left: 10px;
        }

        .f-right {
            position: absolute;
            right: 10px;
        }

        .f-right select {
            height: 20px;
        }

        .f-right a {
            cursor: pointer;
            font-weight: 600;
        }

        .f-right a.active {
            color: #1890FF;
        }

        .f-right a:hover {
            color: #1890FF;
        }

        .niceScroll {
            height: calc(100% - 30px);
            padding: 0px 10px;
        }

        .layui-table, .layui-table-view {
            margin: 0px;
            border: none;
        }

        .layui-table-view .layui-table td, .layui-table-view .layui-table th {
            border-left: 1px solid #e6e6e6;
            padding: 5px 0px;
        }

        .layui-table-view .layui-table th {
            text-align: center;
        }

        .layui-table-page, .layui-table-total {
            border-width: 1px 1px 0px;
        }

        .layui-table-body {
            margin-bottom: 0px;
            margin-right: 0px;
        }

        .layui-form-radio > i:hover, .layui-form-radioed > i {
            color: #187fcc;
        }

        .layui-table tbody tr:hover {
            background: transparent;
        }

        .layui-btn-skyblue {
            background: #1890FF;
        }

        .layui-laypage .layui-laypage-curr .layui-laypage-em {
            background: #177BD0;
        }

        [lay-skin=primary].layui-form-checked i {
            border-color: #187FCC;
        }

        [lay-skin=primary].layui-form-checked i {
            background: #187FCC;
        }

        .hide {
            display: none;
        }

        #charts2 {
            height: 100%;
        }

        .layui-table-view [lay-size=sm].layui-table .layui-table-cell {
            height: auto;
            line-height: 22px;
        }

        .layui-table-cell, .layui-table-tool-panel li {
            padding: 0px 0px;
            overflow: auto;
            white-space: normal;
        }

        .layui-table-cell {
            height: auto;
        }

        .layui-table tr td {
            text-align: center;
        }

        .layui-table-total .layui-table tr:hover {
            background: #F2F2F2;
        }

        .layui-table td, .layui-table th {
            border: 1px solid #949494;
        }

        .layui-table-view .layui-table td, .layui-table-view .layui-table th {
            border-top: 1px solid #949494;
            border-left: 1px solid #949494;
        }

        tbody > tr[data-index="0"] {
            color: #1E9FFF;
        }

        tbody > tr[data-index="0"] > td[data-field="0"] > div {
            display: none;
        }

        .noPosition {
            color: #8d4654 !important;
        }

        .layui-nav .layui-nav-item {
            line-height: 20px;
        }

        .layui-nav > .layui-nav-item > a {
            padding: 0 20px;
            font-size: 12px;
            color: #fff;
        }

        .layui-nav {
            padding: 0;
            background: #009688;
        }

        .layui-nav-bar {
            display: none;
        }

        .layui-nav-child {
            line-height: 30px;
        }

        #navlist {
            left: auto !important;
            right: 0;
            top: 25px !important;
        }

        .layui-nav .layui-nav-child dd.layui-this a, .layui-nav-child dd.layui-this {
            background: #fff;
            color: #000;
        }
    </style>
</head>

<body class="white">
<div class="top">
    <div class="top-left">
        <div class="title_div">
            <span class="strong"><span class="XZQ"></span>农村占用耕地建房情况统计</span>
            <span class="f-right">
                <!--<div class="layui-btn-group">-->
                <!--<button onclick="submit()" type="button" class="layui-btn layui-btn-xs layui-btn-normal">批量审核</button>-->
                <!--<button onclick="submitOne()" type="button"-->
                <!--class="layui-btn layui-btn-xs layui-btn-normal">单个审核</button>-->
                <!--</div>-->
                <!--<div class="layui-btn-group">-->
                <!--<button onclick="checkShi()" type="button"-->
                        <!--class="layui-btn layui-btn-xs layui-btn-normal">按市检查</button>-->
                <!--</div>-->
                <div class="layui-btn-group">
	        	 <button onclick="UndoRurallandnByProvience2()" type="button"
                         class="layui-btn layui-btn-xs layui-btn-danger">单个退回</button>
                </div>
                <div class="layui-btn-group">
                <button onclick="StopApproval()" type="button"
                        class="layui-btn layui-btn-xs layui-btn-warm">全部禁止提交</button>
                <button onclick="StopApproval2()" type="button"
                        class="layui-btn layui-btn-xs layui-btn-warm">单个禁止提交</button>
                <button onclick="RestoreApproval()" type="button"
                        class="layui-btn layui-btn-xs layui-btn-warm">全部恢复提交</button>
                <button onclick="RestroeApproval2()" type="button"
                        class="layui-btn layui-btn-xs layui-btn-warm">单个恢复提交</button>
                </div>
                <div class="layui-btn-group">
	        	 <!--<button id="export" type="button" class="layui-btn layui-btn-xs">导出统计表</button>-->
                    <!--<button id="export2" type="button" class="layui-btn layui-btn-xs">导出全省统计表</button>-->
                    <button id="export3" type="button" class="layui-btn layui-btn-xs">导出全省提交情况</button>
                </div>
                <div class="layui-btn-group" style="margin-left:-2px;">
                 <ul class="layui-nav layui-bg-green">
                    <li class="layui-nav-item">
                        <a href="javascript:;">导出统计表</a>
                        <dl id="navlist" class="layui-nav-child">
                            <dd><a id="export" href="javascript:;">统计表</a></dd>
                            <dd><a id="export2" href="javascript:;">全省汇总表</a></dd>
                            <dd><a id="export4" href="javascript:;">二调前统计表</a></dd>
                            <dd><a id="export5" href="javascript:;">二调后统计表</a></dd>
                            <dd><a id="exportByYear" href="javascript:;">按建设年份导出</a></dd>
                            <dd><a id="exportByYears" href="javascript:;">按年份汇总表</a></dd>
                            <dd><a id="export6" href="javascript:;">登记明细表</a></dd>
                        </dl>
                    </li>
                </ul>
                </div>
	        </span>
        </div>
        <div class="niceScroll table1_div">
            <table id="table1" lay-filter="table1">

            </table>
        </div>
    </div>

</div>
<div class="bottom">
    <div class="top-right">
        <div class="title_div">
            <span class="strong"><span class="SMC"></span>农村占用耕地建房情况统计</span>
            <button class="layui-btn layui-btn-xs layui-btn-normal hideBottomBtn">隐藏</button>
            <span class="f-right">
	        	 <button id="export1" type="button" class="layui-btn layui-btn-xs layui-btn-normal">导出统计表</button>
	        </span>
        </div>
        <div class="niceScroll table2_div">
            <table id="table2" lay-filter="table2">

            </table>
        </div>
    </div>

</div>

</body>
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs layui-btn-skyblue" lay-event="detail"></i>分配</a>
    <!-- <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="edit"></i>审核</a>-->
</script>
<script src="../../js/jquery-2.1.0.js"></script>
<script src="../../js/config.js"></script>
<script src="../../js/common.js"></script>
<script src="../../js/scrollbar/jquery.nicescroll.min.js"></script>
<script src="../../js/layui/layui.js"></script>
<script src="../../js/modules/layui-config.js"></script>
<script src="../../js/openlayers/ol-debug.js"></script>
<script src="../../js/openlayers/maptool.js"></script>
<script src="../../js/zTreeStyle/jquery.ztree.js"></script>
<script src="../../js/echars4.2.1/echarts.min.js"></script>
<script src="../../js/scrollbar/jquery.nicescroll.min.js"></script>
<script src="../../js/SSXstatic.js"></script>
<script>
    var exportByYearIndex;

    function statisticInit() {
        StatisticsfByCitys();
    }

    $("#export").click(function () {
//  	layuitable.exportFile("table1", layuitable.cache.table1,'xls');
        var that = $(this);
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        that.attr("disabled", true).addClass("layui-btn-disabled");
        RurallandOutputExcelService('/OutputTJBByRecord', {
            xzqdm: parent.JFZD.XZQDM,
            record: jsonstr
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });
    $("#export1").click(function () {
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        $(this).attr("disabled", true).addClass("layui-btn-disabled");
        var checkStatus = layuitable.checkStatus("table1");
        var that = $(this);
        RurallandOutputExcelService('/OutputTJBByRecord', {
            xzqdm: checkStatus.data[0].XZQDM,
            record: jsonstr1
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });


    $("#export2").click(function () {//输出全省的统计表
        var that = $(this);
        that.attr("disabled", true).addClass("layui-btn-disabled");
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputProvidenceTable', {
            shzt: 6,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    $("#export3").click(function () {//输出全省的统计表
        var that = $(this);
        that.attr("disabled", true).addClass("layui-btn-disabled");
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputRuralRosterTJQKToALL', {
            xzqdm: parent.JFZD.XZQDM,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    $("#export4").click(function () {//输出二调前
        var that = $(this);
        that.attr("disabled", true).addClass("layui-btn-disabled");
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputProvidenceTable2009', {
            shzt: 6,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    $("#export5").click(function () {//输出二调后
        var that = $(this);
        that.attr("disabled", true).addClass("layui-btn-disabled");
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputProvidenceTable2010', {
            shzt: 6,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    $("#export6").click(function () {//输出登记明细表
        var that = $(this);
        that.attr("disabled", true).addClass("layui-btn-disabled");
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputDJBByHBS2', {
            xzqdm: parent.JFZD.XZQDM
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            that.attr("disabled", false).removeClass("layui-btn-disabled");
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    function exportByYearRes(startYear, endYear) {//按时间输出
        layer.close(exportByYearIndex);
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputProvidenceTablebyYear', {
            shzt: 6,
            startYear: startYear,
            endYear: endYear
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    }

    $("#exportByYear").click(function () {//选择时间
        exportByYearIndex = layer.open({
            type: 2,
            title: false,
            closeBtn: 0, //不显示关闭按钮
            shade: [0],
            skin: 'layui-layer-lan',
            area: ['470px', '135px'],
            anim: 2,//弹出动画
            shade: 0.2,//遮盖层
            content: ['exportByYear.html', 'no'], //这里content是一个普通的String
        });
    });

    $("#exportByYears").click(function () {//输出按年份统计表
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandOutputExcelService('/OutputProvidenceTableByYear2', {
            shzt: 6,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            if (resjson.indexOf("false") > -1) {
                return;
            } else {
                window.open(resjson.trim());
            }
        });
    });

    //提交
    function submit() {
        RurallandService("/UpRurallandnByProvience", {
            userid: parent.JFZD.ID,
            xzqdm: parent.JFZD.XZQDM
        }, true, function (resjson) {
            if (resjson.indexOf("true") > -1) {
                parent.layer.alert("提交成功!");
            } else {
                parent.layer.alert("没有要提交的记录!")
            }
        });
    }

    function submitOne() {
        var checkStatus = layuitable.checkStatus("table1");
        var XZQDM = parent.JFZD.XZQDM;
        var SMC = checkStatus.data[0].XZQMC;

        parent.layer.confirm('确定提交 ' + SMC + " ?", function (index) {
            parent.layer.close(index);
            RurallandService("/UpRurallandnByProvience2", {
                xzqdm: XZQDM,
                userid: parent.JFZD.ID,
                smc: SMC
            }, true, function (resjson) {
                if (resjson.indexOf("true") > -1) {
                    parent.layer.alert("提交成功!");
                    StatisticsfByCitys();
                } else {
                    parent.layer.alert("没有可提交数据!");
                }
            });
        });
    }

    function UndoRurallandnByProvience2() {
        var checkStatus = layuitable.checkStatus("table1");
        var XZQDM = parent.JFZD.XZQDM;
        var SMC = checkStatus.data[0].XZQMC;

        parent.layer.confirm('确定退回 ' + SMC + " 的数据?", function (index) {
            parent.layer.close(index);
            RurallandService("/UndoRurallandnByProvience2", {
                xzqdm: XZQDM,
                userid: parent.JFZD.ID,
                smc: SMC
            }, true, function (resjson) {
                if (resjson.indexOf("true") > -1) {
                    parent.layer.alert("退回成功!");
                    StatisticsfByCitys();
                } else {
                    parent.layer.alert("没有可退回数据!")
                }
            });
        });
    }

    function checkShi(){
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        var XZQDM = checkStatus.data[0].XZQDM;
        var SMC = checkStatus.data[0].XZQMC;

        RurallandStatisticsService('/CheckRurallandBycity3', {
            xzqdm: XZQDM,
        }, true, function (resjson) {
            parent.layer.close(parent.layer.loadIndex);
            if (resjson.indexOf("false") > -1) {
                parent.layer.alert("访问服务器失败!");
                return;
            } else {
                var resjosn = $.parseJSON(resjson);
                if (resjosn.length > 0) {
                    var str = "";
                    $.each(resjosn, function (i, v) {
                        str += v.XMC + v.XZMC + v.CSQMC + v.COUNT + "条错误;\n";
                    });
                    parent.layer.alert(str);
                } else {
                    parent.layer.alert("没有逻辑错误!");
                }
            }
        });
    }

    function StatisticsfByCitys() {
        $(".XZQ").text(parent.JFZD.XZQ);
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        RurallandStatisticsService("/StatisticsfByCitys", {xzqdm: parent.JFZD.XZQDM}, true, function (resjson) {
            if (resjson.indexOf("false") > -1) {
                parent.layer.alert("未查询到结果!");
                parent.layer.close(parent.layer.loadIndex);
                var resjosn = [];
            } else {
                var resjosn = $.parseJSON(resjson);
                jsonstr = JSON.stringify(resjosn);
            }
            addTotal(resjosn);
            var height = $(".table1_div").height();
            layuitable.render({
                elem: '#table1',
                height: height - 5,
                page: false, //开启分页
                limit: resjosn.length,
                size: 'sm',
                id: 'table1',
                cols: [
                    [
                        {type: 'radio', width: 55, rowspan: 4},//
                        {field: 'XZQMC', title: '所属单位', rowspan: 4, width: 60, totalRowText: '合计'},//
                        {field: '', title: '总体情况', colspan: 5},
                        {field: '', title: '居住用房', colspan: 12},
                        {field: '', title: '工矿厂房', colspan: 4},
                        {field: '', title: '经营用房', colspan: 4},
                        {field: '', title: '设施农业用房', colspan: 4},
                    ],
                    [
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2,},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {
                            field: 'ZJBNTMJ', title: '占用基本农田面积(亩)', rowspan: 3, totalRow: true, templet: function (d) {
                                return d.ZJBNTMJ.toFixed(2);
                            }
                        },
                        {field: '', title: '自住', colspan: 5},
                        {field: '', title: '销售', colspan: 7},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                    ],
                    [
                        {field: '', title: '占用耕地建房个数', colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', colspan: 2},
                        {field: 'ZZYSXJFGS', title: '本村村民建房符合“一户一宅”条件个数', rowspan: 2, totalRow: true},//ZZFHTJGS3
                        {field: '', title: '占用耕地建房个数', colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', colspan: 2},
                        {field: '', title: '销售套数', colspan: 3},
                    ],
                    [
                        {field: 'ZTYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'ZTWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'ZTYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.ZTYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'ZTWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.ZTWSXGDMJ.toFixed(2);
                            }
                        },

                        {field: 'ZZWSXJFGS', title: '有手续', totalRow: true},//8
                        {
                            field: 'ZZYSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.ZZYSXGDMJ.toFixed(2);
                            }
                        },//9
                        {
                            field: 'ZZWSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.ZZWSXGDMJ.toFixed(2);
                            }
                        },//10
                        {field: 'ZZFHTJGS', title: '无手续', totalRow: true},//11

                        {field: 'XSYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'XSWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'XSYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.XSYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'XSWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.XSWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'XSTSBCCM', title: '本村村民', rowspan: 2, totalRow: true},
                        {field: 'XSTSWCCM', title: '外村村民', rowspan: 2, totalRow: true},
                        {field: 'XSTSCZJM', title: '城镇居民', rowspan: 2, totalRow: true},
                        {field: 'GCYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'GCWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'GCYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.GCYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'GCWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.GCWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'JYYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'JYWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'JYYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.JYYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'JYWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.JYWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'NYYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'NYWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'NYYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.NYYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'NYWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.NYWSXGDMJ.toFixed(2);
                            }
                        },
                    ]
                ],
                data: resjosn,
                done: function () {
                    //判断哪儿个禁止提交了
                    ApprovalStatus2(resjosn);
                }
            });
            layuitable.on('radio(table1)', function (obj) {
                var data = obj.data;
                var checkStatus = layuitable.checkStatus("table1");
                StatisticsfByCity(checkStatus.data[0].XZQDM, checkStatus.data[0].XZQMC);
                toggleBottom(true);
                resetTableSize();
            });

            var table1_div = $(".table1_div").height();
            var header = $(".table1_div .layui-table-header").height();
            $(".table1_div .layui-table-body").height(table1_div - header - 5);
            parent.layer.close(parent.layer.loadIndex);
        });
    }


    function StatisticsfByCity(XZQDM, SMC) {
        $("#export1").attr("disabled", false).removeClass("layui-btn-disabled");
        $(".SMC").text(SMC);
        parent.layer.loadIndex = parent.layer.load(0, {shade: 0.1});
        if (parent.JFZD.USERNAME == "sysadmin") {
            var url = "/StatisticsfByCityAdministrator";
        } else {
            var url = "/HomeStatisticsfByCity2";
        }

        RurallandStatisticsService(url, {xzqdm: XZQDM, smc: SMC}, true, function (resjson) {
            if (resjson.indexOf("false") > -1) {
                parent.layer.alert("未查询到结果!");
                parent.layer.close(parent.layer.loadIndex);
                var resjosn = [];
            } else {
                var resjosn = $.parseJSON(resjson);
                jsonstr1 = JSON.stringify(resjosn);
            }
            addTotal(resjosn);
            var height = $(".table2_div").height();
            layuitable.render({
                elem: '#table2',
                height: height - 5,
                page: false, //开启分页
                limit: resjosn.length,
                size: 'sm',
//              totalRow: true,
                cols: [
                    [
                        {field: 'XZQMC', title: '所属单位', rowspan: 4, width: 60, totalRowText: '合计'},//
                        {field: '', title: '总体情况', colspan: 5},
                        {field: '', title: '居住用房', colspan: 12},
                        {field: '', title: '工矿厂房', colspan: 4},
                        {field: '', title: '经营用房', colspan: 4},
                        {field: '', title: '设施农业用房', colspan: 4},
                    ],
                    [
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2,},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {
                            field: 'ZJBNTMJ', title: '占用基本农田面积(亩)', rowspan: 3, totalRow: true, templet: function (d) {
                                return d.ZJBNTMJ.toFixed(2);
                            }
                        },
                        {field: '', title: '自住', colspan: 5},
                        {field: '', title: '销售', colspan: 7},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地建房个数', rowspan: 2, colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', rowspan: 2, colspan: 2},
                    ],
                    [
                        {field: '', title: '占用耕地建房个数', colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', colspan: 2},
                        {field: 'ZZYSXJFGS', title: '本村村民建房符合“一户一宅”条件个数', rowspan: 2, totalRow: true},//ZZFHTJGS3
                        {field: '', title: '占用耕地建房个数', colspan: 2},
                        {field: '', title: '占用耕地总面积(亩)', colspan: 2},
                        {field: '', title: '销售套数', colspan: 3},
                    ],
                    [
                        {field: 'ZTYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'ZTWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'ZTYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.ZTYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'ZTWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.ZTWSXGDMJ.toFixed(2);
                            }
                        },

                        {field: 'ZZWSXJFGS', title: '有手续', totalRow: true},//8
                        {
                            field: 'ZZYSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.ZZYSXGDMJ.toFixed(2);
                            }
                        },//9
                        {
                            field: 'ZZWSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.ZZWSXGDMJ.toFixed(2);
                            }
                        },//10
                        {field: 'ZZFHTJGS', title: '无手续', totalRow: true},//11

                        {field: 'XSYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'XSWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'XSYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.XSYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'XSWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.XSWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'XSTSBCCM', title: '本村村民', rowspan: 2, totalRow: true},
                        {field: 'XSTSWCCM', title: '外村村民', rowspan: 2, totalRow: true},
                        {field: 'XSTSCZJM', title: '城镇居民', rowspan: 2, totalRow: true},
                        {field: 'GCYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'GCWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'GCYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.GCYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'GCWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.GCWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'JYYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'JYWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'JYYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.JYYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'JYWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.JYWSXGDMJ.toFixed(2);
                            }
                        },
                        {field: 'NYYSXJFGS', title: '有手续', totalRow: true},
                        {field: 'NYWSXJFGS', title: '无手续', totalRow: true},
                        {
                            field: 'NYYSXGDMJ', title: '有手续', totalRow: true, templet: function (d) {
                                return d.NYYSXGDMJ.toFixed(2);
                            }
                        },
                        {
                            field: 'NYWSXGDMJ', title: '无手续', totalRow: true, templet: function (d) {
                                return d.NYWSXGDMJ.toFixed(2);
                            }
                        },
                    ]
                ],
                data: resjosn,
            });
            var table2_div = $(".table2_div").height();
            var header = $(".table2_div .layui-table-header").height();
            $(".table2_div .layui-table-body").height(table2_div - header - 5);
            parent.layer.close(parent.layer.loadIndex);
        });
    }

</script>

</html>
